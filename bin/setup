#!/usr/bin/env bash
set -euo pipefail
IFS=$'\n\t'
set -vx

bundle install

# Check if the database already exists
if psql -U postgres -tAc "SELECT 1 FROM pg_database WHERE datname='sourced_test'" | grep -q 1; then
  echo "Database 'sourced_test' already exists, skipping creation."
else
  psql -U postgres -c "CREATE DATABASE sourced_test"
fi
